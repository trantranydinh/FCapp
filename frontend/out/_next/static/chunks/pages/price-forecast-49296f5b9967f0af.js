(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[920,365],{6230:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/price-forecast",function(){return s(5263)}])},3472:function(e,t,s){"use strict";s.d(t,{Z:function(){return o}});var a=s(5893),r=s(316),n=s(4606),i=s(4088),l=s(6915),d=s(3311),c=s(4819);function o(e){let{title:t,value:s,change:o,changeLabel:u="vs last 7 days",badge:m,icon:x,trend:h="neutral"}=e,p="up"===h?i.Z:"down"===h?l.Z:d.Z;return(0,a.jsxs)(r.Zb,{className:"bg-card border border-border shadow-none overflow-hidden relative group",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 to-accent/5 opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none"}),(0,a.jsxs)(r.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2 relative z-10",children:[(0,a.jsx)(r.ll,{className:"text-sm font-medium text-muted-foreground",children:t}),m&&(0,a.jsx)(n.C,{variant:m.variant||"outline",className:"text-xs font-medium shadow-sm",children:m.label})]}),(0,a.jsx)(r.aY,{className:"relative z-10",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[x&&(0,a.jsx)("div",{className:(0,c.cn)("p-2 rounded-lg bg-primary/5 group-hover:bg-primary/10 transition-colors","up"===h?"text-success":"down"===h?"text-destructive":"text-primary"),children:(0,a.jsx)(x,{className:"h-5 w-5"})}),(0,a.jsx)("div",{className:"text-2xl font-bold tracking-tight text-foreground",children:s||"—"})]}),void 0!==o&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:(0,c.cn)("flex items-center gap-1 text-xs px-2 py-1 rounded-full font-medium","up"===h?"text-success bg-success/10":"down"===h?"text-destructive bg-destructive/10":"text-muted-foreground bg-secondary"),children:[(0,a.jsx)(p,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:o})]}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:u})]})]})})]})}},5411:function(e,t,s){"use strict";var a=s(5893),r=s(7294),n=s(3148),i=s(6495),l=s(7202),d=s(4819);n.kL.register(n.uw,n.f$,n.od,n.jn,n.Dx,n.u,n.De,n.Gu),t.Z=e=>{var t,s;let{historyDates:n=[],historyPrices:c=[],forecast:o}=e,[u,m]=(0,r.useState)(!1),[x,h]=(0,r.useState)("ALL");(0,r.useEffect)(()=>{m(!0)},[]);let p=(0,r.useMemo)(()=>{if(!n.length)return{dates:[],prices:[]};let e=0;switch(x){case"7D":e=7;break;case"1M":e=30;break;case"3M":e=90;break;case"1Y":e=365;break;default:e=n.length}e>n.length&&(e=n.length);let t=n.length-e;return{dates:n.slice(t),prices:c.slice(t)}},[n,c,x]),f=p.dates.length>0,g=(null==o?void 0:null===(t=o.forecast_dates)||void 0===t?void 0:t.length)>0&&(null==o?void 0:null===(s=o.median_prices)||void 0===s?void 0:s.length)>0;if(!u)return(0,a.jsx)("div",{className:"h-[300px] flex items-center justify-center text-muted-foreground",children:"Loading chart..."});if(!f&&!g)return(0,a.jsx)("div",{className:"h-[300px] flex items-center justify-center text-muted-foreground",children:"No data available"});let v=[...p.dates];g&&v.push(...o.forecast_dates);let b=e=>{let t=e.chart.ctx.createLinearGradient(0,0,0,400);return t.addColorStop(0,"rgba(239, 68, 68, 0.5)"),t.addColorStop(1,"rgba(239, 68, 68, 0.0)"),t},j=[];if(f&&j.push({label:"Historical Price",data:p.prices,borderColor:"#ef4444",backgroundColor:e=>b(e),tension:.4,fill:!0,pointRadius:0,pointHoverRadius:6,pointBackgroundColor:"#ef4444",pointBorderColor:"#fff",pointBorderWidth:2,borderWidth:2}),g){let e=Array(p.prices.length).fill(null),t=p.prices[p.prices.length-1],s=[t,...o.median_prices],a=e.slice(0,-1);if(j.push({label:"AI Forecast",data:[...a,...s],borderColor:"#dc2626",backgroundColor:"transparent",borderDash:[5,5],tension:.4,pointRadius:0,pointHoverRadius:6,pointBackgroundColor:"#dc2626",pointBorderColor:"#fff",pointBorderWidth:2,borderWidth:2}),o.upper_band&&o.lower_band){let e=[t,...o.upper_band],s=[t,...o.lower_band];j.push({label:"Confidence Range",data:[...a,...e],borderColor:"transparent",backgroundColor:"rgba(239, 68, 68, 0.1)",fill:"+1",pointRadius:0,tension:.4}),j.push({label:"Lower Band",data:[...a,...s],borderColor:"transparent",backgroundColor:"transparent",fill:!1,pointRadius:0,tension:.4})}}return(0,a.jsxs)("div",{className:"w-full h-full flex flex-col",children:[(0,a.jsx)("div",{className:"flex justify-end mb-4 gap-1",children:["7D","1M","3M","1Y","ALL"].map(e=>(0,a.jsx)(l.z,{variant:x===e?"default":"ghost",size:"sm",onClick:()=>h(e),className:(0,d.cn)("h-7 text-xs px-2",x===e?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground"),children:e},e))}),(0,a.jsx)("div",{className:"flex-1 min-h-[300px] w-full",children:(0,a.jsx)(i.x1,{data:{labels:v,datasets:j},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{display:!0,position:"top",align:"end",labels:{usePointStyle:!0,boxWidth:6,font:{size:11}}},tooltip:{backgroundColor:"rgba(15, 23, 42, 0.9)",titleColor:"#fff",bodyColor:"#cbd5e1",borderColor:"rgba(255,255,255,0.1)",borderWidth:1,padding:10,cornerRadius:8,displayColors:!0,callbacks:{label:e=>{if("Lower Band"===e.dataset.label||"Confidence Range"===e.dataset.label)return null;let t=e.dataset.label||"";return t&&(t+=": "),null!==e.parsed.y&&(t+=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e.parsed.y)),t}}}},scales:{x:{grid:{display:!1},ticks:{maxTicksLimit:8,font:{size:10},color:"#94a3b8"}},y:{grid:{color:"rgba(255, 255, 255, 0.05)",drawBorder:!1},ticks:{font:{size:10},color:"#94a3b8",callback:e=>"$"+e}}}}})})]})}},4606:function(e,t,s){"use strict";s.d(t,{C:function(){return l}});var a=s(5893);s(7294);var r=s(2003),n=s(4819);let i=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-success text-white hover:bg-success/80",warning:"border-transparent bg-warning text-white hover:bg-warning/80"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)(i({variant:s}),t),...r})}},316:function(e,t,s){"use strict";s.d(t,{Ol:function(){return l},SZ:function(){return c},Zb:function(){return i},aY:function(){return o},eW:function(){return u},ll:function(){return d}});var a=s(5893),r=s(7294),n=s(4819);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-2xl border bg-card text-card-foreground shadow-sm",s),...r})});i.displayName="Card";let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...r})});l.displayName="CardHeader";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});d.displayName="CardTitle";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...r})});c.displayName="CardDescription";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",s),...r})});o.displayName="CardContent";let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",s),...r})});u.displayName="CardFooter"},285:function(e,t,s){"use strict";s.d(t,{SO:function(){return i},__:function(){return l},hd:function(){return d}});var a=s(5068),r=s(7365);let n=async e=>{try{return(await r.api.get(e)).data}catch(e){(0,r.handleError)(e)}},i=()=>(0,a.ZP)("/api/v1/dashboard/market-sentiment",n),l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;return(0,a.ZP)("/api/v1/dashboard/news-summary?limit=".concat(e),n)},d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;return(0,a.ZP)("/api/v1/price/historical-data?months_back=".concat(e),n)}},7365:function(e,t,s){"use strict";s.r(t),s.d(t,{api:function(){return n},handleError:function(){return i}});var a=s(7066);let r=s(7061).env.NEXT_PUBLIC_BACKEND_URL||"",n=a.Z.create({baseURL:r,withCredentials:!0}),i=e=>{if(e.response){var t,s,a;throw console.error("[API Error]",{status:e.response.status,url:null===(t=e.response.config)||void 0===t?void 0:t.url,data:e.response.data}),Error((null===(s=e.response.data)||void 0===s?void 0:s.message)||(null===(a=e.response.data)||void 0===a?void 0:a.error)||"Request failed with status ".concat(e.response.status))}if("ERR_NETWORK"===e.code||"Network Error"===e.message)throw Error("Cannot connect to backend server. Please ensure backend is running on http://localhost:50005. Run: cd backend && npm run dev");throw Error(e.message||"Network error")}},1593:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1462).Z)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},3552:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1462).Z)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},1952:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1462).Z)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},3023:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1462).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},5263:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return T}});var a=s(5893),r=s(7294),n=s(9008),i=s.n(n),l=s(1298),d=s(5411),c=s(3472),o=s(1462);let u=(0,o.Z)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);var m=s(1593),x=s(316),h=s(4606);function p(e){let{confidence:t=85,factors:s=[{name:"Global Supply Chain",impact:"High",direction:"negative"},{name:"Seasonal Demand",impact:"Medium",direction:"positive"},{name:"Currency Fluctuation",impact:"Low",direction:"neutral"}],summary:r="The model predicts a bullish trend due to tightening supply in major export regions."}=e;return(0,a.jsxs)(x.Zb,{className:"glass-card border-none overflow-hidden relative",children:[(0,a.jsx)(x.Ol,{className:"pb-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"p-1.5 rounded-lg bg-accent/10 text-accent",children:(0,a.jsx)(u,{className:"h-4 w-4"})}),(0,a.jsx)(x.ll,{className:"text-base font-semibold",children:"AI Forecast Insights"})]})}),(0,a.jsxs)(x.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"p-3 rounded-lg bg-background/50 border border-border/50 text-sm leading-relaxed",children:[(0,a.jsx)("span",{className:"font-semibold text-primary mr-1",children:"AI Analysis:"}),r]}),(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Model Confidence"}),(0,a.jsxs)("span",{className:"font-bold text-foreground",children:[t,"%"]})]}),(0,a.jsx)("div",{className:"h-2 w-full bg-muted/50 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-primary relative",style:{width:"".concat(t,"%")}})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Top Influencing Factors"}),(0,a.jsx)("div",{className:"space-y-2",children:s.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-md hover:bg-secondary transition-colors group",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"h-1.5 w-1.5 rounded-full ".concat("positive"===e.direction?"bg-success":"negative"===e.direction?"bg-destructive":"bg-warning")}),(0,a.jsx)("span",{className:"text-sm font-medium",children:e.name})]}),(0,a.jsxs)(h.C,{variant:"outline",className:"text-[10px] h-5 bg-transparent group-hover:bg-background/50 transition-colors",children:[e.impact," Impact"]})]},t))})]}),(0,a.jsx)("div",{className:"pt-2",children:(0,a.jsxs)("button",{className:"text-xs text-primary hover:text-primary/80 flex items-center gap-1 transition-colors",children:["View full model details ",(0,a.jsx)(m.Z,{className:"h-3 w-3"})]})})]})]})}var f=s(5197);let g=(0,o.Z)("arrow-up-right",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),v=(0,o.Z)("arrow-down-right",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);var b=s(63),j=s(4088);let y=(0,o.Z)("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var N=s(3023),w=s(4819),k=s(7365);let _=e=>{let{title:t,value:s,trend:r,trendValue:n,icon:i,signalColor:l,status:d,loading:c}=e;return(0,a.jsxs)(x.Zb,{className:"panel-executive overflow-hidden relative group hover:border-primary/30 transition-all duration-300",children:[(0,a.jsx)("div",{className:(0,w.cn)("absolute top-0 left-0 w-1 h-full",l)}),(0,a.jsxs)(x.aY,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:t}),c?(0,a.jsx)(f.Z,{className:"h-6 w-6 mt-1 animate-spin text-muted-foreground"}):(0,a.jsx)("h3",{className:"text-2xl font-semibold mt-1 tracking-tight text-foreground",children:s})]}),(0,a.jsx)("div",{className:(0,w.cn)("p-2 rounded-md bg-secondary/50 text-foreground group-hover:bg-secondary transition-colors","border border-border/50"),children:(0,a.jsx)(i,{className:"h-5 w-5"})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:["up"===r&&(0,a.jsx)(g,{className:"h-4 w-4 text-success"}),"down"===r&&(0,a.jsx)(v,{className:"h-4 w-4 text-destructive"}),"neutral"===r&&(0,a.jsx)(b.Z,{className:"h-4 w-4 text-warning"}),(0,a.jsx)("span",{className:(0,w.cn)("text-sm font-medium","up"===r?"text-success":"down"===r?"text-destructive":"text-warning"),children:n}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground ml-1",children:d})]})]})]})};function C(){var e,t,s,n,i,l,d;let[c,o]=(0,r.useState)(null),[u,m]=(0,r.useState)(!0),x=async()=>{try{m(!0);let e=await k.api.get("/api/v1/dashboard/overview");e.success&&o(e.data)}catch(e){console.error("Failed to fetch dashboard overview:",e)}finally{m(!1)}};(0,r.useEffect)(()=>{x();let e=setInterval(x,3e5);return()=>clearInterval(e)},[]);let h=(null==c?void 0:c.key_metrics)||{},p=(null==c?void 0:c.market_insights)||{},g=p.signals||[];return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-end justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:"Market Signals"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"AI-driven market intelligence summary for the current period."})]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground font-mono uppercase",children:["LAST SYNC: ",(null==c?void 0:c.timestamp)?new Date(c.timestamp).toLocaleTimeString():"---"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsx)(_,{title:"Current Market Price",value:h.current_price?"$".concat(h.current_price.toLocaleString()," / MT"):"---",trend:h.trend_percentage>0?"up":h.trend_percentage<0?"down":"neutral",trendValue:"".concat(h.trend_percentage>0?"+":"").concat(h.trend_percentage||0,"%"),status:"projected trend",icon:j.Z,signalColor:"bg-primary",loading:u}),(0,a.jsx)(_,{title:"Model Confidence",value:h.confidence?"".concat(h.confidence,"%"):"---",trend:"neutral",trendValue:"Operational",status:"prediction weight",icon:y,signalColor:"bg-success",loading:u}),(0,a.jsx)(_,{title:"Market Regime",value:(null===(t=p.market_regime)||void 0===t?void 0:null===(e=t.state)||void 0===e?void 0:e.replace("_"," "))||"ANALYZING",trend:"neutral",trendValue:(null===(s=p.market_regime)||void 0===s?void 0:s.strength)||"Checking",status:"regime strength",icon:N.Z,signalColor:"bg-warning",loading:u})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-muted-foreground uppercase",children:"Key AI Insights"}),(0,a.jsxs)("div",{className:"bg-secondary/30 border border-border rounded-md p-4 space-y-3 min-h-[100px]",children:[u?(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsx)(f.Z,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):g.length>0?g.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:(0,w.cn)("w-1.5 h-1.5 rounded-full mt-2 shrink-0","OPPORTUNITY"===e.status||"INFO"===e.status?"bg-success":"WARNING"===e.status?"bg-warning":"bg-destructive")}),(0,a.jsx)("p",{className:"text-sm text-foreground",children:e.message})]},t)):(0,a.jsx)("p",{className:"text-sm text-muted-foreground italic",children:"No specific signals detected at this time."}),p.ai_summary&&!u&&(0,a.jsx)("div",{className:"pt-2 border-t border-border/50 mt-2",children:(0,a.jsxs)("p",{className:"text-sm text-primary font-medium italic",children:['"',p.ai_summary,'"']})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-muted-foreground uppercase mb-4",children:"Market Status"}),(0,a.jsxs)("div",{className:"bg-secondary/30 border border-border rounded-md p-4 space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"AI Intelligence"}),(0,a.jsx)("span",{className:(0,w.cn)("font-medium",(null==c?void 0:c.status)==="healthy"?"text-success":"text-warning"),children:(null==c?void 0:c.status)==="healthy"?"Active":"Degraded"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Market Volatility"}),(0,a.jsx)("span",{className:"text-foreground font-medium",children:(null===(n=p.key_metrics)||void 0===n?void 0:n.volatility_30d)?"".concat((100*p.key_metrics.volatility_30d).toFixed(2),"%"):"---"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"RSI (14)"}),(0,a.jsx)("span",{className:(0,w.cn)("font-medium",(null===(i=p.key_metrics)||void 0===i?void 0:i.rsi)>70?"text-destructive":(null===(l=p.key_metrics)||void 0===l?void 0:l.rsi)<30?"text-success":"text-foreground"),children:(null===(d=p.key_metrics)||void 0===d?void 0:d.rsi)?p.key_metrics.rsi.toFixed(1):"---"})]})]})]})]})]})}var Z=s(7202);let S=(0,o.Z)("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);var M=s(1952),F=s(7400);let z=(0,o.Z)("chart-no-axes-column-increasing",[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V9",key:"uvy0l4"}],["path",{d:"M19 21V3",key:"11j9sm"}]]),L=(0,o.Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),A=[{id:1,label:"Upload",icon:S},{id:2,label:"Preprocess",icon:M.Z},{id:3,label:"AI Analysis",icon:F.Z},{id:4,label:"Evaluate",icon:z},{id:5,label:"Forecast",icon:u}];function R(e){let{currentStep:t=1}=e;return(0,a.jsx)("div",{className:"w-full py-4",children:(0,a.jsxs)("div",{className:"relative flex items-center justify-between w-full",children:[(0,a.jsx)("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-full h-1 bg-muted rounded-full -z-10",children:(0,a.jsx)("div",{className:"h-full bg-gradient-to-r from-primary to-accent transition-all duration-500 ease-out rounded-full",style:{width:"".concat((t-1)/(A.length-1)*100,"%")}})}),A.map(e=>{let s=e.icon,r=e.id<t,n=e.id===t;return(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2 group",children:[(0,a.jsxs)("div",{className:(0,w.cn)("relative flex h-10 w-10 items-center justify-center rounded-full border-2 transition-all duration-300 bg-background",r?"border-primary bg-primary text-primary-foreground scale-110":n?"border-accent text-accent ring-4 ring-accent/20 scale-125":"border-muted-foreground/30 text-muted-foreground"),children:[r?(0,a.jsx)(L,{className:"h-5 w-5 animate-in zoom-in duration-300"}):(0,a.jsx)(s,{className:"h-5 w-5"}),n&&(0,a.jsx)("span",{className:"absolute inline-flex h-full w-full rounded-full bg-accent opacity-20 animate-ping"})]}),(0,a.jsx)("span",{className:(0,w.cn)("text-xs font-medium transition-colors duration-300 absolute -bottom-6 whitespace-nowrap",n?"text-accent font-bold":r?"text-primary":"text-muted-foreground"),children:e.label})]},e.id)})]})})}var E=s(285);let D=(0,o.Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var I=s(5913),P=s(3552);let O=e=>"".concat(e>0?"+":"").concat(Number(e||0).toFixed(2),"%");var T=()=>{var e,t,s,n,o;let[u,m]=(0,r.useState)(null),[h,g]=(0,r.useState)(!1),[v,b]=(0,r.useState)(!1),[y,N]=(0,r.useState)(60),[w,_]=(0,r.useState)(1),{data:S,mutate:F}=(0,E.hd)(0),z=async()=>{try{g(!0),_(2);let e=(await k.api.post("/api/v1/price/sync-lakehouse",{},{timeout:12e4})).data;if(e&&e.isAuthRequired){let{userCode:t,verificationUri:s}=e;window.confirm("Authentication Required (Microsoft Device Login)\n\n"+"1. Copy this code: ".concat(t,"\n")+"2. Click OK to open the login page.\n3. Paste the code and sign in.\n\nAfter you finish signing in, click the 'Fetch Data' button again.")&&window.open(s,"_blank");return}if(e&&e.success){_(3);let e=y||60,t=await k.api.post("/api/v1/price/fetch-forecast",{forecast_days:e});_(4),setTimeout(()=>{_(5),t.data&&t.data.success&&m(t.data.data)},800),F()}}catch(s){console.error((0,k.handleError)(s)),_(1);{var e,t;let a=(null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||s.message||"Unknown error";a.includes("RESPONSE_SENT")||window.alert("Lakehouse Sync Failed: "+a)}}finally{g(!1)}},L=async()=>{try{let e=await k.api.get("/api/v1/price/latest");m(e.data.data)}catch(e){if(e.response&&404===e.response.status){m(null);return}console.warn("Failed to load latest forecast:",e.message)}};(0,r.useEffect)(()=>{L()},[]);let A=async e=>{try{g(!0),N(e);let t=await k.api.post("/api/v1/price/fetch-forecast",{forecast_days:e});t.data&&t.data.success&&m(t.data.data)}catch(e){console.error((0,k.handleError)(e))}finally{g(!1)}},T=Math.round(100*((null==u?void 0:u.confidenceScore)||0)),H=100*((null==u?void 0:u.trendPercentage)||0);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i(),{children:(0,a.jsx)("title",{children:"Price Forecast | Cashew Forecast"})}),(0,a.jsx)(l.Z,{title:"Price Forecast",children:(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsx)(C,{}),(0,a.jsx)("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:(0,a.jsx)("div",{className:"xl:col-span-3 space-y-6",children:(0,a.jsxs)(x.Zb,{className:"bg-card border border-border shadow-none relative overflow-hidden",children:[(0,a.jsxs)(x.Ol,{children:[(0,a.jsxs)(x.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(D,{className:"h-5 w-5 text-primary"}),"Forecast Data Source"]}),(0,a.jsx)(x.SZ,{children:"Fetch latest price predictions directly from Azure Fabric Lakehouse"})]}),(0,a.jsxs)(x.aY,{className:"space-y-6",children:[(0,a.jsx)(R,{currentStep:w}),(1===w||w>=5)&&(0,a.jsx)("div",{className:"flex flex-col space-y-4 animate-in fade-in slide-in-from-bottom-4 duration-500",children:(0,a.jsx)(x.Zb,{className:"border-dashed border-2 border-border/50 bg-accent/5",children:(0,a.jsxs)(x.aY,{className:"flex flex-col items-center justify-center py-8 text-center space-y-4",children:[(0,a.jsx)("div",{className:"bg-primary/10 p-4 rounded-full",children:(0,a.jsx)(I.Z,{className:"h-8 w-8 text-primary"})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg",children:"Connect to Fabric Lakehouse"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground max-w-sm mx-auto",children:"Securely fetch the latest pre-calculated forecast data ('FC' Table) from your organizational OneLake."})]}),(0,a.jsx)(Z.z,{onClick:z,size:"lg",className:"w-48 gap-2",disabled:h,children:h?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 animate-spin"}),"Syncing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P.Z,{className:"h-4 w-4"}),"Fetch Forecast"]})}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground pt-2",children:["Source: ",(0,a.jsx)("strong",{children:"Production Lakehouse (SQL Endpoint)"})]})]})})}),w>1&&w<5&&(0,a.jsxs)("div",{className:"h-48 flex flex-col items-center justify-center text-center space-y-4 animate-in fade-in zoom-in duration-300",children:[(0,a.jsxs)("div",{className:"relative h-16 w-16",children:[(0,a.jsx)("div",{className:"absolute inset-0 rounded-full border-4 border-muted opacity-20"}),(0,a.jsx)("div",{className:"absolute inset-0 rounded-full border-4 border-t-accent border-r-transparent border-b-transparent border-l-transparent animate-spin"}),(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center font-bold text-xl text-accent",children:"AI"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Syncing Data..."}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Retrieving latest forecast models from Lakehouse"})]})]})]})]})})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-4 gap-6",children:[(0,a.jsxs)(x.Zb,{className:"xl:col-span-3 glass-card border-none",children:[(0,a.jsx)(x.Ol,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(x.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(D,{className:"h-5 w-5 text-primary"}),"Forecast Horizon"]}),(0,a.jsx)(x.SZ,{children:"Select time period to view"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(Z.z,{variant:"outline",size:"sm",className:"gap-2",children:[(0,a.jsx)(P.Z,{className:"h-4 w-4"})," Export PDF"]}),(0,a.jsxs)(Z.z,{variant:"outline",size:"sm",className:"gap-2",children:[(0,a.jsx)(M.Z,{className:"h-4 w-4"})," CSV"]})]})]})}),(0,a.jsx)(x.aY,{children:(0,a.jsx)("div",{className:"flex flex-wrap gap-3",children:[30,60,90,180].map(e=>(0,a.jsx)(Z.z,{onClick:()=>A(e),disabled:h,variant:y===e&&h?"default":"outline",className:"min-w-[100px] hover:bg-primary/5 hover:text-primary hover:border-primary/50 transition-all duration-300",children:h&&y===e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Running..."]}):"".concat(e," Days")},e))})})]}),(0,a.jsx)(c.Z,{title:"Projected Trend",value:(null==u?void 0:u.trendLabel)||"UNKNOWN",change:H?O(H):void 0,changeLabel:"strength",badge:(o=null==u?void 0:u.trendLabel)?"UP"===o||"BULLISH"===o?{label:"Bullish",variant:"success"}:"DOWN"===o||"BEARISH"===o?{label:"Bearish",variant:"destructive"}:{label:"Neutral",variant:"outline"}:{label:"Unknown",variant:"outline"},icon:j.Z,trend:H?H>0?"up":H<0?"down":"neutral":"neutral"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[(0,a.jsxs)(x.Zb,{className:"xl:col-span-2 glass-card border-none min-h-[500px] flex flex-col",children:[(0,a.jsxs)(x.Ol,{children:[(0,a.jsx)(x.ll,{children:"Price Forecast Visualization"}),(0,a.jsx)(x.SZ,{children:"Historical prices vs Fabric Lakehouse forecast predictions"})]}),(0,a.jsx)(x.aY,{className:"flex-1",children:(null==u?void 0:u.detailedData)||(null==S?void 0:null===(e=S.data)||void 0===e?void 0:e.dates)?(0,a.jsx)(d.Z,{history:(null==S?void 0:null===(t=S.data)||void 0===t?void 0:t.dates)?{dates:S.data.dates,prices:S.data.prices}:void 0,forecast:(null==u?void 0:u.detailedData)||{forecast_dates:(null==u?void 0:u.dates)||[],forecast_prices:(null==u?void 0:u.prices)||[],lower_bound:(null==u?void 0:u.lower_bound)||[],upper_bound:(null==u?void 0:u.upper_bound)||[]}}):(0,a.jsx)("div",{className:"flex h-full items-center justify-center text-muted-foreground",children:(0,a.jsxs)("div",{className:"text-center space-y-2",children:[(0,a.jsx)(j.Z,{className:"h-12 w-12 mx-auto opacity-20"}),(0,a.jsx)("p",{children:"No forecast data available."}),(0,a.jsx)("p",{className:"text-sm",children:"Click 'Fetch Forecast' above to sync."})]})})})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(p,{confidence:T||99,summary:(null==u?void 0:u.summary)||"Forecast data synchronized from Azure Fabric Lakehouse.",factors:[{name:"Lakehouse Table",impact:"High",direction:"positive"},{name:"Model Version",impact:"FC_2025_v1",direction:"neutral"}]}),(0,a.jsxs)(x.Zb,{className:"bg-card border border-border shadow-none",children:[(0,a.jsx)(x.Ol,{children:(0,a.jsx)(x.ll,{className:"text-base",children:"Forecast Metadata"})}),(0,a.jsx)(x.aY,{children:(0,a.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between border-b border-border/50 pb-2",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Source"}),(0,a.jsx)("span",{className:"font-semibold",children:(null==u?void 0:null===(s=u.metadata)||void 0===s?void 0:s.source)||"Azure Lakehouse"})]}),(0,a.jsxs)("div",{className:"flex justify-between border-b border-border/50 pb-2",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Horizon"}),(0,a.jsxs)("span",{className:"font-semibold",children:[(null==u?void 0:u.forecastDays)||y||"—"," Days"]})]}),(0,a.jsxs)("div",{className:"flex justify-between border-b border-border/50 pb-2",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Synced At"}),(0,a.jsx)("span",{className:"font-semibold",children:(null==u?void 0:u.timestamp)?new Date(u.timestamp).toLocaleTimeString():new Date().toLocaleTimeString()})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Data Points"}),(0,a.jsx)("span",{className:"font-semibold",children:((null==u?void 0:u.dates)||(null==u?void 0:null===(n=u.detailedData)||void 0===n?void 0:n.forecast_dates)||[]).length})]})]})})]})]})]})]})})]})}}},function(e){e.O(0,[196,474,552,66,20,537,298,888,774,179],function(){return e(e.s=6230)}),_N_E=e.O()}]);